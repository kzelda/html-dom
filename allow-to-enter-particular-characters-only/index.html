<html lang="en"><head>
    <meta charset="utf-8">
    <title>HTML DOM - Allow to enter particular characters only</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="author" content="Nguyen Huu Phuoc">
	<meta name="description" content="Manage HTML DOM with vanilla JavaScript">
    
	<meta name="twitter:site" content="@nghuuphuoc">
	<meta name="twitter:title" content="Manage HTML DOM with vanilla JavaScript">
	<meta name="twitter:description" content="Manage HTML DOM with vanilla JavaScript">
    <meta name="twitter:creator" content="@nghuuphuoc">
    <meta name="twitter:image" content="https://htmldom.dev/assets/screenshot.png">

	<meta property="og:site_name" content="HTML DOM">
	<meta property="og:title" content="Manage HTML DOM with vanilla JavaScript">
	<meta property="og:description" content="Manage HTML DOM with vanilla JavaScript">
    <meta property="og:url" content="https://htmldom.dev">
    <meta property="og:image" content="https://htmldom.dev/assets/screenshot.png">
    
    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro&amp;display=swap" rel="stylesheet">
<link href="/html-dom/vendor-styles.f51019ab61c61bfaec14.css" rel="stylesheet"><link href="/html-dom/client.3072e4ce2bf9ca91f138.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://www.google-analytics.com"><script charset="utf-8" src="/html-dom/posts-add-or-remove-class-from-an-element~posts-allow-to-enter-particular-characters-only~posts-appe~7d800c42.9c372392c5470c46721a.js"></script><script charset="utf-8" src="/html-dom/posts-add-or-remove-class-from-an-element~posts-allow-to-enter-particular-characters-only~posts-appe~98070671.eb632b1036286151ad8b.js"></script><script charset="utf-8" src="/html-dom/posts-allow-to-enter-particular-characters-only~posts-communication-between-an-iframe-and-its-parent~d35237b2.d6e2c58f381bcc69e41d.js"></script><script charset="utf-8" src="/html-dom/posts-allow-to-enter-particular-characters-only.3eafa96f7a159b76e526.js"></script><meta name="description" content="Allow to enter particular characters only" data-react-helmet="true"><meta name="keywords" content="addEventListener, input event, keypress event, preventDefault, selectionEnd, selectionStart, setSelectionRange" data-react-helmet="true"><link rel="preconnect" href="https://fonts.gstatic.com"></head>
<body class="font-sans w-full">
    <div id="root" class="flex flex-col min-h-full"><div class="flex-1 px-2 lg:px-0"><div class="ml-auto mr-auto max-w-3xl mb-8"><div class="flex items-center justify-between py-8"><a class="bg-black p-1 rounded text-2xl sm:text-3xl font-light text-white" href="/html-dom/">&lt;/dom&gt;</a><div class="w-2/3 sm:w-1/2"><div class="w-full relative"><div class="border-b border-gray-400"><input class="border-none w-full p-2 flex-1" placeholder="Filter" value=""></div><button class="absolute border-none p-2 right-0 top-0"><svg viewBox="0 0 24 24" style="fill:none;height:24px;stroke:rgba(0,0,0,.4);stroke-linecap:round;stroke-linejoin:round;stroke-width:1;width:24px"><path d="M10.5,0.5c5.523,0,10,4.477,10,10s-4.477,10-10,10s-10-4.477-10-10S4.977,0.5,10.5,0.5z M23.5,23.5 l-5.929-5.929"></path></svg></button></div></div></div><div class="mt-32 text-center"><span class="bg-black text-white text-3xl px-3 py-2 rounded">2/95</span></div><h1 class="font-bold mt-4 mb-4 text-center text-3xl lg:text-4xl px-1">Allow to enter particular characters only</h1><div class="mb-12 text-center"><a class="text-2xl bg-gray-400 px-4 py-2" href="https://github.com/phuoc-ng/html-dom/blob/master/client/posts/allow-to-enter-particular-characters-only/index.tsx" rel="noopener noreferrer" target="_blank" style="text-decoration:none">Edit this page</a></div><div class="mb-4"><p class="mb-2">In this example, we will force users to enter characters from given set only. Specifically, the supported characters
in this demonstration include the digits and space. Of course, you can apply the idea for other characters as well.</p><p class="mb-2">Here is our input element:</p><pre class="hljs mb-8"><code class="html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"input"</span> /&gt;</span></code></pre><h2 class="text-2xl sm:text-3xl mb-4">1. Handle the events</h2><p class="mb-2">By handling the <code>keypress</code> event, we can prevent user from entering characters except digits and space:</p><pre class="hljs mb-8"><code class="javascript"><span class="hljs-keyword">const</span> ele = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'input'</span>);

ele.addEventListener(<span class="hljs-string">'keypress'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-comment">// Get the code of pressed key</span>
    <span class="hljs-keyword">const</span> key = e.which || e.keyCode;

    <span class="hljs-comment">// 0, 1, ..., 9 have key code of 48, 49, ..., 57, respectively</span>
    <span class="hljs-comment">// Space has key code of 32</span>
    <span class="hljs-keyword">if</span> (key != <span class="hljs-number">32</span> &amp;&amp; (key &lt; <span class="hljs-number">48</span> || key &gt; <span class="hljs-number">57</span>)) {
        <span class="hljs-comment">// Prevent the default action</span>
        e.preventDefault();
    }
});</code></pre><p class="mb-2">It looks good but isn't enough since user is still able to paste or drag unsupported characters to the input.
These cases can be handled by the <code>input</code> event:</p><pre class="hljs mb-8"><code class="javascript"><span class="hljs-comment">// Track the current value</span>
<span class="hljs-keyword">let</span> currentValue = ele.value || <span class="hljs-string">''</span>;

ele.addEventListener(<span class="hljs-string">'input'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">const</span> target = e.target;

    <span class="hljs-comment">// If users enter supported character (digits or space)</span>
    <span class="hljs-regexp">/^[0-9\s]*$/</span>.test(target.value)
        <span class="hljs-comment">// Backup the current value</span>
        ? currentValue = target.value
        <span class="hljs-comment">// Otherwise, restore the value</span>
        <span class="hljs-comment">// Note that in this case, `e.preventDefault()` doesn't help</span>
        : target.value = currentValue;
});</code></pre><p class="mb-2">Here we check if the value matches the regular expression <code>/^[0-9\s]*$/</code> that covers the digit and space characters.</p><p class="mb-2">It fixes the cases where users paste from the keyboard (<code>Ctrl + V</code>), context menu or drop text to the input.</p><p class="mb-2">But there's another issue. Calling <code>target.value = currentValue</code> will put the cursor at the end of input.
We have to persist the cursor's position.</p><pre class="hljs mb-8"><code class="javascript"><span class="hljs-comment">// Track the current cursor's position</span>
<span class="hljs-keyword">const</span> selection = {};

ele.addEventListener(<span class="hljs-string">'keydown'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">const</span> target = e.target;
    selection = {
        <span class="hljs-attr">selectionStart</span>: target.selectionStart,
        <span class="hljs-attr">selectionEnd</span>: target.selectionEnd,
    };
});</code></pre><p class="mb-2">When user changes the input value, we will restore both the value and selection positions if the value isn't supported:</p><pre class="hljs mb-8"><code class="javascript">ele.addEventListener(<span class="hljs-string">'input'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">const</span> target = e.target;

    <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^[0-9s]*$/</span>.test(target.value)) {
        currentValue = target.value;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// Users enter the not supported characters</span>
        <span class="hljs-comment">// Restore the value and selection</span>
        target.value = currentValue;
        target.setSelectionRange(
            selection.selectionStart,
            selection.selectionEnd
        );
    }
});</code></pre><p class="mb-2">We can combine the tracked properties (<code>value</code>, <code>selectionStart</code> and <code>selectionEnd</code>) to a single variable as you
see in the demo at the end.</p><h2 class="text-2xl sm:text-3xl mb-4">2. Use the special input</h2><p class="mb-2">We can use a special HTML 5 input to serve particular use cases:</p><table class="border border-gray-400 mb-8"><thead><tr class="border-t border-gray-400 bg-gray-100"><td class="p-3"><code>input</code></td><td class="p-3">Description</td></tr></thead><tbody><tr class="border-t border-gray-400"><td class="p-3"><code>&lt;input type="color" /&gt;</code></td><td class="p-3">Let user specify a color</td></tr><tr class="border-t border-gray-400"><td class="p-3"><code>&lt;input type="date" /&gt;</code></td><td class="p-3">Let user enter a date</td></tr><tr class="border-t border-gray-400"><td class="p-3"><code>&lt;input type="email" /&gt;</code></td><td class="p-3">Let user enter an email address</td></tr><tr class="border-t border-gray-400"><td class="p-3"><code>&lt;input type="number" /&gt;</code></td><td class="p-3">Let user enter numbers only</td></tr><tr class="border-t border-gray-400"><td class="p-3"><code>&lt;input type="tel" /&gt;</code></td><td class="p-3">Let user enter a telephone number</td></tr><tr class="border-t border-gray-400"><td class="p-3"><code>&lt;input type="time" /&gt;</code></td><td class="p-3">Let user enter a time</td></tr><tr class="border-t border-gray-400"><td class="p-3"><code>&lt;input type="url" /&gt;</code></td><td class="p-3">Let user enter a URL</td></tr></tbody></table><p class="mb-2">There are more built-in types that you can explore <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#%3Cinput%3E_types" class="underline">here</a>.</p><p class="mb-2">In our specific example, <code>&lt;input type="number" /&gt;</code> doesn't help because it doesn't allow to enter a space.</p><div class="my-4"><div class="inline-flex px-2 py-1 bg-gray-400"><div class="mr-2">Demo</div>(<a class="underline" href="https://github.com/phuoc-ng/html-dom/blob/master//demo/allow-to-enter-particular-characters-only/index.html" target="_blank">source</a>)</div><div class="border border-gray-400 relative"><iframe class="border-none w-full" src="/html-dom/demo/allow-to-enter-particular-characters-only/index.html" style="height:150px"></iframe></div></div><h2 class="text-2xl sm:text-3xl mb-4 mt-8">Might be useful</h2><ul><li class="mb-2"><a class="bg-gray-200 px-2 py-1 flex items-center justify-between" href="/html-dom/attach-or-detach-an-event-handler"><span>Attach or detach an event handler</span><span class="p-1 text-white rounded bg-gray-600">basic</span></a></li><li class="mb-2"><a class="bg-gray-200 px-2 py-1 flex items-center justify-between" href="/html-dom/prevent-the-default-action-of-an-event"><span>Prevent the default action of an event</span><span class="p-1 text-white rounded bg-gray-600">basic</span></a></li></ul></div><div class="mb-2"><a class="text-xl sm:text-2xl" title="Add or remove class from an element" href="/html-dom/add-or-remove-class-from-an-element">← Add or remove class from an element</a></div><div class="mb-2 text-right"><a class="text-xl sm:text-2xl" title="Append to an element" href="/html-dom/append-to-an-element">Append to an element →</a></div></div></div><div class="border-t pt-6 pb-16 border-gray-400"><div class="ml-auto mr-auto max-w-3xl px-2 lg:px-0"><div class="text-center mb-8"><div class="mb-4">Hit the Subscribe button for the latest news on my tools. No spam. Ever!</div><form action="https://csslayout.us4.list-manage.com/subscribe/post?u=77d0bf6497a2cdbb36f08587c&amp;id=e8a912009a" method="post" name="mc-embedded-subscribe-form" target="_blank" novalidate=""><input class="border border-gray-400 p-2 w-56 sm:w-64" type="email" name="EMAIL" placeholder="Email address" required=""><div aria-hidden="true" style="left:-5000px;position:absolute"><input type="text" name="b_77d0bf6497a2cdbb36f08587c_e8a912009a" tabindex="-1"></div><button type="submit" name="subscribe" class="bg-blue-600 border border-blue-600 px-4 py-2 text-white">Subscribe</button></form></div><div><h3 class="text-xl sm:text-2xl font-semibold mb-2">Products</h3><ul class="flex flex-wrap -ml-1 -mr-1"><li class="w-1/2 sm:w-1/3 px-1 mb-6"><a href="https://blur.page" rel="noopener noreferrer" target="_blank" title="BlurPage - a browser extension to hide sensitive element on page" style="text-decoration:none"><div class="font-semibold">Blur Page</div><span class="text-gray-600">a browser extension to hide sensitive element on page</span></a></li><li class="w-1/2 sm:w-1/3 px-1 mb-6"><a href="https://csslayout.io" rel="noopener noreferrer" target="_blank" title="CSS Layout - a collection of popular layouts and patterns made with CSS" style="text-decoration:none"><div class="font-semibold">CSS Layout</div><span class="text-gray-600">a collection of popular layouts and patterns made with CSS</span></a></li><li class="w-1/2 sm:w-1/3 px-1 mb-6"><a href="https://fakenumbers.io" rel="noopener noreferrer" target="_blank" title="Fake Numbers - a JavaScript library to fake a number" style="text-decoration:none"><div class="font-semibold">Fake Numbers</div><span class="text-gray-600">a JavaScript library to fake a number</span></a></li><li class="w-1/2 sm:w-1/3 px-1 mb-6"><a href="https://formvalidation.io" rel="noopener noreferrer" target="_blank" title="FormValidation - the best validation library for JavaScript" style="text-decoration:none"><div class="font-semibold">Form Validation</div><span class="text-gray-600">the best validation library for JavaScript</span></a></li><li class="w-1/2 sm:w-1/3 px-1 mb-6"><a href="https://htmldom.dev" rel="noopener noreferrer" target="_blank" title="HTML DOM - Common tasks of managing HTML DOM with native API" style="text-decoration:none"><div class="font-semibold">HTML DOM</div><span class="text-gray-600">common tasks of managing HTML DOM with vanilla JavaScript</span></a></li><li class="w-1/2 sm:w-1/3 px-1 mb-6"><a href="https://react-pdf-viewer.dev" rel="noopener noreferrer" target="_blank" title="React PDF Viewer - a PDF viewer made for React" style="text-decoration:none"><div class="font-semibold">React PDF Viewer</div><span class="text-gray-600">a PDF viewer made for React</span></a></li></ul></div><div class="mt-6"><h3 class="text-xl sm:text-2xl font-semibold mb-2">Follow me <span class="font-light text-gray-600 ml-2">I love building products!</span></h3><ul class="flex"><li class="flex-1"><a href="https://twitter.com/nghuuphuoc" rel="noopener noreferrer" target="_blank" style="text-decoration:none"><div class="font-semibold">Twitter</div><span class="text-gray-600">@nghuuphuoc</span></a></li><li class="flex-1"><a href="https://dev.to/phuocng" rel="noopener noreferrer" target="_blank" style="text-decoration:none"><div class="font-semibold">dev.to</div><span class="text-gray-600">@phuocng</span></a></li><li class="flex-1"><a href="https://github.com/phuoc-ng" rel="noopener noreferrer" target="_blank" style="text-decoration:none"><div class="font-semibold">GitHub</div><span class="text-gray-600">@phuoc-ng</span></a></li></ul></div><div class="pt-4">© 2020 Nguyen Huu Phuoc. All rights reserved</div></div></div></div>
<script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-139616701-7"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-139616701-7');
</script>
<script type="text/javascript" src="/html-dom/runtime.84ee7acf870e2850d336.js"></script><script type="text/javascript" src="/html-dom/vendor-styles.29a48c3a7835c7a67150.js"></script><script type="text/javascript" src="/html-dom/vendors.fbef9d73430672c1b7d0.js"></script><script type="text/javascript" src="/html-dom/client.5973423c0edd7eb2ee54.js"></script>

</body></html>